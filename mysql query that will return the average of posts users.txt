select user_id,
       count(*) / count(distinct yearweek(created_at)) as week_average,
       count(*) / count(distinct year(created_at), month(created_at)) as month_average
from posts group by user_id;